$(document).ready((function(){function n(){let n=0;$(".order-item").each((function(){const e=parseFloat($(this).find(".order-item-price").text().replace("$",""));isNaN(e)||(n+=e)}));const e=.05*n,o=n+e+2.5;$(".order-total-row:eq(0) span:eq(1)").text("$"+n.toFixed(2)),$(".order-total-row:eq(2) span:eq(1)").text("$"+e.toFixed(2)),$(".order-total-row.final span:eq(1)").text("$"+o.toFixed(2)),function(){let n=0;t().forEach((e=>{n+=e.quantity})),$(".badge").text(n)}()}function e(){const e=t();if($(".order-items").empty(),0===e.length)$(".order-items").html('<p class="empty-cart">Your cart is empty. <a href="foods.html">Browse foods</a> to add items.</p>');else for(const n of e)r(n);n(),console.log("Order page initialized with cart items: ",e)}function t(){return JSON.parse(localStorage.getItem("foodCart"))||[]}function o(n){localStorage.setItem("foodCart",JSON.stringify(n));const e=new Event("cartUpdated");document.dispatchEvent(e)}function r(n){const e=`\n            <div class="order-item" data-name="${n.name}">\n                <div class="order-item-img">\n                    <img src="${n.image}" alt="${n.name}" />\n                </div>\n                <div class="order-item-info">\n                    <div class="order-item-name">${n.name}</div>\n                    <div class="order-item-price">$${(n.price*n.quantity).toFixed(2)}</div>\n                    <div class="order-item-quantity">\n                        <button class="quantity-btn decrease">-</button>\n                        <span class="quantity-value">${n.quantity}</span>\n                        <button class="quantity-btn increase">+</button>\n                    </div>\n                </div>\n                <div class="order-item-remove">\n                    <i class="fa fa-trash"></i>\n                </div>\n            </div>\n        `;$(".order-items").append(e)}function i(e,r){let i=t();const a=i.findIndex((n=>n.name===e));if(-1!==a){i[a].quantity=r;const t=i[a].price;$(`.order-item[data-name="${e}"]`).find(".order-item-price").text("$"+(t*r).toFixed(2)),o(i),n()}}e(),document.addEventListener("cartUpdated",(function(){e()})),$(document).on("click",".quantity-btn.increase",(function(){const n=$(this).siblings(".quantity-value");const e=parseInt(n.text())+1;n.text(e);i($(this).closest(".order-item").data("name"),e),$(this).closest(".order-item").fadeOut(100).fadeIn(100)})),$(document).on("click",".quantity-btn.decrease",(function(){const n=$(this).siblings(".quantity-value");let e=parseInt(n.text());if(e>1){const t=e-1;n.text(t);i($(this).closest(".order-item").data("name"),t),$(this).closest(".order-item").fadeOut(100).fadeIn(100)}})),$(document).on("click",".order-item-remove",(function(){const e=$(this).closest(".order-item"),r=e.data("name");e.slideUp(300,(function(){$(this).remove(),function(e){let r=t();r=r.filter((n=>n.name!==e)),o(r),0===r.length&&$(".order-items").html('<p class="empty-cart">Your cart is empty. <a href="foods.html">Browse foods</a> to add items.</p>'),n()}(r)}))})),$(".payment-method").on("click",(function(){$(".payment-method").removeClass("active"),$(this).addClass("active")})),$("form").on("submit",(function(n){n.preventDefault(),0!==$(".order-item").length?function(){let n=!0;$("form input, form textarea").each((function(){$(this).prop("required")&&!$(this).val().trim()?($(this).addClass("error"),n=!1):$(this).removeClass("error")})),n||alert("Please fill in all required fields.");return n}()&&(!function(){const n='\n            <div class="order-modal">\n                <div class="order-modal-content">\n                    <div class="order-modal-header">\n                        <h3>Order Confirmation</h3>\n                        <span class="close-modal">&times;</span>\n                    </div>\n                    <div class="order-modal-body">\n                        <div class="confirmation-icon">\n                            <i class="fa fa-check-circle"></i>\n                        </div>\n                        <p>Thank you for your order!</p>\n                        <p>Your order has been placed successfully.</p>\n                        <p>Order details have been sent to your email.</p>\n                        <p>Estimated delivery time: 30-45 minutes</p>\n                    </div>\n                    <div class="order-modal-footer">\n                        <button class="btn-primary" id="continue-shopping">Continue Shopping</button>\n                    </div>\n                </div>\n            </div>\n        ';$("body").append(n),$("<style>").text("\n                .order-modal {\n                    position: fixed;\n                    top: 0;\n                    left: 0;\n                    width: 100%;\n                    height: 100%;\n                    background: rgba(0, 0, 0, 0.7);\n                    z-index: 9999;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    animation: fadeIn 0.3s ease;\n                }\n                .order-modal-content {\n                    background: white;\n                    border-radius: 15px;\n                    width: 90%;\n                    max-width: 500px;\n                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n                    animation: slideIn 0.4s ease;\n                    overflow: hidden;\n                }\n                .order-modal-header {\n                    padding: 20px;\n                    border-bottom: 1px solid #eee;\n                    position: relative;\n                }\n                .order-modal-header h3 {\n                    margin: 0;\n                    color: #333;\n                }\n                .close-modal {\n                    position: absolute;\n                    right: 20px;\n                    top: 20px;\n                    font-size: 24px;\n                    cursor: pointer;\n                    color: #999;\n                    transition: all 0.3s ease;\n                }\n                .close-modal:hover {\n                    color: rgb(226, 74, 74);\n                }\n                .order-modal-body {\n                    padding: 30px;\n                    text-align: center;\n                }\n                .confirmation-icon {\n                    font-size: 60px;\n                    color: #4cd137;\n                    margin-bottom: 20px;\n                    animation: pulse 2s infinite;\n                }\n                .order-modal-body p {\n                    margin-bottom: 10px;\n                    color: #666;\n                    font-size: 16px;\n                }\n                .order-modal-body p:first-of-type {\n                    font-size: 22px;\n                    color: #333;\n                    font-weight: 600;\n                    margin-bottom: 15px;\n                }\n                .order-modal-footer {\n                    padding: 20px;\n                    text-align: center;\n                    border-top: 1px solid #eee;\n                }\n                @keyframes fadeIn {\n                    from { opacity: 0; }\n                    to { opacity: 1; }\n                }\n                @keyframes slideIn {\n                    from { transform: translateY(-50px); opacity: 0; }\n                    to { transform: translateY(0); opacity: 1; }\n                }\n                @keyframes pulse {\n                    0% { transform: scale(1); }\n                    50% { transform: scale(1.1); }\n                    100% { transform: scale(1); }\n                }\n                .empty-cart {\n                    text-align: center;\n                    padding: 30px 0;\n                    color: #666;\n                }\n                .empty-cart a {\n                    color: rgb(226, 74, 74);\n                    font-weight: 500;\n                }\n                .error {\n                    border-color: rgb(226, 74, 74) !important;\n                    box-shadow: 0 0 0 3px rgba(226, 74, 74, 0.2) !important;\n                }\n            ").appendTo("head"),$(".close-modal, #continue-shopping").on("click",(function(){$(".order-modal").fadeOut(300,(function(){$(this).remove(),window.location.href="foods.html"}))}))}(),localStorage.removeItem("foodCart")):alert("Please add items to your order before proceeding.")})),window.addEventListener("storage",(function(n){"foodCart"===n.key&&e()}))}));